% LTeX: lang=en-US

\section{Monotone Protcols}
\label{sec:monotone-protocols}
\begin{definition}
  \label{monotone_protocol_definition}
  A monotone protocol is a simple-aggregation protocol (as defined in Definition~\ref{simple-aggregation-definition}) over the monoid
  $(\Gamma^*, \cdot, \varepsilon)$
  where $\Gamma^*$ is the set of all strings over the alphabet $\Gamma$,
  $\cdot$ is the concatenation operation,
  and $\varepsilon$ is the empty string.
\end{definition}
\newcommand{\lcp}[1]{\operatorname{\bigwedge}_{#1}}

Monotone protocols are interesting because they capture a natural class of functions called rational functions that can be computed by bimachines \cite{schutzenberger1961remark} \footnote{The terminology "Bimachine" is due to Eilenberg \cite{Eilenberg74}.}. The equivalence between monotone protocols and rational functions, is a simple corollary of the Reutenauer-Sch端tzenberger Theorem \cite{reutenauer1991minimization} which we are going to explain it at beginning of this section. To do so, we define the notion of \emph{Hankel Property} for every function $f \colon \Sigma^* \to \Gamma^*$. Then we state the Reutenauer-Sch端tzenberger Theorem that every function is rational if and only if it has the Hakel Property. We are going to show that Hankel Property and monotone protocols are equivalent, i.e., every function expressed by a monotone protocol has the Hankel Property and every function that has the Hankel Property can be expressed by a monotone protocol. Therefore any function expressed by a monotone protocol is rational and vice versa. 

\label{hankel-property-and-monotone-protocols}

\begin{definition}[Hankel Property]
  A function $f \colon \Sigma^* \to \Gamma^*$ is said to have the Hankel Property if there exists a constant $K > 0$ and functions $\beta_1, \beta_2, \ldots, \beta_K \colon \Sigma^* \to \Gamma^*$ and $\gamma_1, \gamma_2, \ldots, \gamma_K \colon \Sigma^* \to \Gamma^*$ such that for every strings $u, v \in \Sigma^*$, we have:
  \[ f(uv) = \bigcup_{i=1}^{K} \beta_i(u) \cdot \gamma_i(v) \] \cite{reutenauerSchutzenberger1991}
\end{definition}
Like the original Reutenauer-Sch端tzenberger Theorem, here we consider each string, and $\emptyset$, to be embedded in the boolean semiring $2^{\Gamma^*}$, with union and prodcut as operations. Therefore, if one of the $\beta_i(u)$ or $\gamma_i(v)$ is $\emptyset$, then the corresponding term in the union is also $\emptyset$ \cite{reutenauerSchutzenberger1991}.

\begin{theorem}[Reutenauer-Sch端tzenberger Theorem]
  \label{Hankel-property-rational-function}
  Every function $f \colon \Sigma^* \to \Gamma^*$ that has the Hankel Property is rational and vice versa. \cite{reutenauerSchutzenberger1991}
\end{theorem}

So now it is enough to show that every function expressed by a monotone protocol has the Hankel Property. We will show in it the next lemma.

\begin{lemma}
  \label{monotone-protocols-hankel-property}
  Every function expressed by a monotone protocol has the Hankel Property.
\end{lemma}
\begin{proof}
  Let $(f_A,f_B,Q_A,Q_B,q_A,q_B)$ be ingredients of a monotone protocol over the monoid $(\Gamma^*, \cdot, \varepsilon)$ that expresses the function $f \colon \Sigma^* \to \Gamma^*$.
  We define functions $\beta_i \colon \Sigma^* \to \Gamma^*$ and $\gamma_i \colon \Sigma^* \to \Gamma^*$ for every $1 \leq i \leq |Q_B| \times |Q_A|$ as follows:
  \begin{itemize}
      \item $\beta_{q,p}(u) = \emptyset$ if $q_A(u) \neq q$ else $\beta_{q,p}(u) = C_A(u)[p]$
      \item $\gamma_{q,p}(v) = \emptyset$ if $q_B(v) \neq p$ else $\gamma_{q,p}(v) = C_B(v)[q]$
  \end{itemize}
  where $1 \leq q \leq |Q_B|$ and $1 \leq p \leq |Q_A|$.
  Now for every strings $u, v \in \Sigma^*$, we have:
  \[ f(uv) = \bigcup_{(q,p) \in Q_B \times Q_A} \beta_{q,p}(u) \cdot \gamma_{q,p}(v) \]
  Thus, $f$ has the Hankel Property.
\end{proof}

\newcommand{\norm}[1]{\left\lVert#1\right\rVert}

\begin{lemma}
  \label{hankel-property-monotone-protocols}
  Every function that has the Hankel Property can be expressed by a monotone protocol.
\end{lemma}

\begin{proof}

  Let $f \colon \Sigma^* \to \Gamma^*$ be a function that has the Hankel Property. Then there exists a constant $K > 0$ and functions $\beta_1, \beta_2, \ldots, \beta_K \colon \Sigma^* \to \Gamma^*$ and $\gamma_1, \gamma_2, \ldots, \gamma_K \colon \Sigma^* \to \Gamma^*$ such that for every strings $u, v \in \Sigma^*$, we have:
  \[ f(uv) = \bigcup_{i=1}^{K} \beta_i(u) \cdot \gamma_i(v) \]
  Now we define a monotone protocol $(f_A,f_B,Q_A,Q_B,q_A,q_B)$ over the monoid $(\Gamma^*, \cdot, \varepsilon)$ that expresses the function $f$ as follows:
  \begin{itemize}
      \item $Q_A = Q_B = 2^{\{1, 2, \ldots, K\}}$
      \item $q_A(u) = \{ i \mid \beta_i(u) \neq \emptyset \}$
      \item $q_B(v) = \{ i \mid \gamma_i(v) \neq \emptyset \}$
      \item $f_A(u, S_B) = \beta_i(u)$ for the unique $i \in S_B \cap q_A(u)$
      \item $f_B(v, S_A) = \gamma_i(v)$ for the unique $i \in S_A \cap q_B(v)$
  \end{itemize}
  Observe that the protcol is well-defined because the function is total and therefore for every strings $u, v \in \Sigma^*$, there exists at least one index $i$ such that $\beta_i(u) \neq \emptyset$ and $\gamma_i(v) \neq \emptyset$ and also it is not possible to have two different indices $i$ and $j$ such that $\beta_i(u) \neq \emptyset$ and $\beta_j(u) \neq \emptyset$ and $\gamma_i(v) \neq \emptyset$ and $\gamma_j(v) \neq \emptyset$ because in this case we would have two different values for $f(uv)$ which is a contradiction. Now for every strings $u, v \in \Sigma^*$, we have:
  \[ f(uv) = \bigcup_{i=1}^{K} \beta_i(u) \cdot \gamma_i(v) \]
  Thus, the monotone protocol expresses the function $f$.
  
\end{proof}

Also we have seen that expressibility by a monotone protocol is equivalent to having the Hankel Property for a function, it is not that obvious that how these two conecpts, i.e., monotone protocols and Hankel Property, are related to each other. To see this relation more clearly, we need to define notion of distance between two strings with respect to a function.


