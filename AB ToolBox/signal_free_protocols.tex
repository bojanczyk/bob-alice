
\section{Signal Free Protocols}

\begin{definition}
    \label{signal-free-simple-aggregation-definition}
A signal-free simple-aggregation protocol over a monoid is a restriction of simple-aggregation protocols in which the signal spaces $Q_A$ and $Q_B$ are singleton sets. In other words, there is no communication between the parties, and each party computes its local output based only on its input. Such a protocol is therefore specified by:
\begin{itemize}
    \item a monoid $(M, \ast, e)$ as the output domain
    \item two functions $f_A: \Sigma^* \to M$ and $f_B: \Sigma^* \to M$ that are computed by Alice and Bob respectively on their local inputs
\end{itemize}
The final output on inputs $x,y$ is $f_A(x)\ast f_B(y)$.
\end{definition}

\begin{theorem}
\label{thm:signal-free-homomorphism}
Let $(M, \ast, e)$ be a monoid, and let $f_A, f_B: \Sigma^* \to M$ be two functions that define a signal-free aggregation protocol over $M$. Then there exists two element $s_A, s_B \in M$ such that the function $f: \Sigma^* \to M$ computed by the protocol can be expressed as:
\[f(w) = s_A \ast h(w) \ast s_B \quad \text{for every } w \in \Sigma^*\]
where $h: \Sigma^* \to M$ is a homomorphism from the free monoid $\Sigma^*$ to the monoid $M$. (Note that $M$ is not necessarily commutative here.)
\end{theorem}
\begin{proof}
    Let $s_A = f_A(\epsilon)$ and $s_B = f_B(\epsilon)$, where $\epsilon$ is the empty string. To prove that $h$ is a homomorphism, first we show that $h(\epsilon) = e$. This is because, assume by contradiction, that $h(\epsilon) \neq e$. Then we have:
    \[f(\epsilon) = f_A(\epsilon) \ast f_B(\epsilon) = s_A \ast s_B \neq s_A \ast e \ast s_B = f(\epsilon)\]
    which is a contradiction. Therefore, $h(\epsilon) = e$. Then we show that for every $u,v \in \Sigma^*$, we have:
    \[h(uv) = h(u) \ast h(v)\]
    This is because observe that $f_A(x)= s_A \ast h(x)$ and $f_B(y)= h(y) \ast s_B$ for every $x,y \in \Sigma^*$. This is because:
    \[f(x) = f_A(x) \ast f_B(\epsilon) = f_A(x) \ast s_B = s_A \ast h(x) \ast s_B,\]
    which implies that $f_A(x) = s_A \ast h(x)$. Symmetrically, we have:
    \[f(y) = f_A(\epsilon) \ast f_B(y) = s_A \ast f_B(y) = s_A \ast h(y) \ast s_B,\]
    which implies that $f_B(y) = h(y) \ast s_B$.
    Now consider two words $u,v \in \Sigma^*$, we give $u$ to Alice and $v$ to Bob as their inputs. Then we have:
    \begin{align*}
    f(uv) & = f_A(u) \ast f_B(v) \\
    & = (s_A \ast h(u)) \ast (h(v) \ast s_B) \\
    & = s_A \ast h(u) \ast h(v) \ast s_B \\
    & = f_A(uv) \ast f_B(\epsilon) \\
    & = (s_A \ast h(uv)) \ast s_B \\
    \end{align*}
    By cancellation of $s_A$ from the left and $s_B$ from the right, we get:
    \[h(uv) = h(u) \ast h(v)\]
    This completes the proof that $h$ is a homomorphism.
\end{proof}

\subsection{Commutative Signal Free Protocols}
\label{sec:commutative-signal-free}

We say that a function $f:\Sigma^* \to {\mathbb D}$ (where ${\mathbb D}$ is any output domain) is commutative if, for every word $u\in\Sigma^*$ and every permutation $\pi$ of the positions of $u$, we have $f(u)=f(\pi(u))$.

In Theorem~\ref{thm:commutative-signal-free}, we show the following: If, in a signal-free aggregation protocol over a commutative monoid, the neutral element $e$ of the monoid is in the image of both $f_A$ and $f_B$, then the protocol computes a commutative function $f:\Sigma^* \to M$.

\begin{theorem}
\label{thm:commutative-signal-free}
Let $(M, \ast, e)$ be a commutative monoid, and let $f_A, f_B: \Sigma^* \to M$ be two functions that define a signal-free aggregation protocol over $M$. If there exist words $w_A^{e}, w_B^{e} \in \Sigma^*$ such that $f_A(w_A^{e}) = e$ and $f_B(w_B^{e}) = e$, then the function $f: \Sigma^* \to M$ computed by the protocol is commutative. That is, for every word $u \in \Sigma^*$ and every permutation $\pi$ of the positions of $u$, we have $f(u) = f(\pi(u))$.
\end{theorem}

\begin{proof}
    First note that with the given conditions, $f_A(\epsilon)$ and $f_B(\epsilon)$ must be invertible elements in the monoid $M$. This is because first we know that there exist $w_A^{e}, w_B^{e} \in \Sigma^*$ such that $f_A(w_A^{e}) = e$ and $f_B(w_B^{e}) = e$. Now consider the words $w_A^{e}$ and $w_B^{e}$. We have:
    \[f(w_A^{e} w_B^{e}) = f_A(w_A^{e}) \ast f_B(w_B^{e}) = e \ast e = e.\]
    On the other hand, by split-invariance of protocols, we also have:
    \[f(w_A^{e} w_B^{e}) = f_A(\epsilon) \ast f_B(w_A^{e} w_B^{e}) = f_A(\epsilon) \ast f_B(w_A^{e} w_B^{e}).\]
    Combining these two equations, we get:
    \[e = f_A(\epsilon) \ast f_B(w_A^{e} w_B^{e}).\]
    This implies that $f_B(w_A^{e} w_B^{e})$ is the inverse of $f_A(\epsilon)$ in the monoid $M$. A similar argument shows that $f_A(w_A^{e} w_B^{e})$ is the inverse of $f_B(\epsilon)$.


    \begin{claim}
    For every word $u \in \Sigma^*$, we have:
    \[f_A(uv)= f_A(vu) \quad \text{and} \quad f_B(uv)= f_B(vu).\]
    \end{claim}  

    \begin{proof}[Proof of Claim]
    We proof the first equality; the second one follows by a symmetric argument. Let $u,v \in \Sigma^*$. First note that the following holds:
    \begin{equation}
        f(w) = f_A(w) \ast f_B(\epsilon) = f_A(\epsilon) \ast f_B(w) \label{eq:1}
    \end{equation}
    multiplying both sides by $f_B(\epsilon)^{-1}$ from the right and considering commutativity, we get:
    \begin{equation}
        f(w) f_B(\epsilon)^{-1} = f_A(w) = f_B(w) \ast f_A(\epsilon) \ast f_B(\epsilon)^{-1} \label{eq:2}
    \end{equation}
    and symmetrically we have:
    \begin{equation}
        f(w) f_A(\epsilon)^{-1} = f_B(w) = f_A(w) \ast f_B(\epsilon) \ast f_A(\epsilon)^{-1} \label{eq:3}
    \end{equation}

    \noindent 
    From Equation~\eqref{eq:2}, we have:

    \begin{equation}
    f_A(uv) = \underbrace{f(uv)}_{f_A(u) \ast f_B(v)} \ast f_B(\epsilon)^{-1}  = f_A(u) \ast f_B(v) \ast f_B(\epsilon)^{-1} \label{eq:4}
    \end{equation}
    \noindent
    Therefore the sequence of equalities below holds:
    \begin{align*}
    f_A(uv) & = f_A(u) \ast f_B(v) \ast f_B(\epsilon)^{-1} & \text{(from equation~\eqref{eq:4})} \\
    & = f_A(u) \ast f_A(v) \ast f_B(\epsilon) \ast f_A(\epsilon)^{-1} \ast f_B(\epsilon)^{-1} & \text{(from equation~\eqref{eq:3})} \\
    & = f_A(u) \ast f_A(v) \ast f_A(\epsilon)^{-1} & \text{(by cancellation)} \\
    & = f_B(u) \ast f_A(\epsilon) \ast f_B(\epsilon)^{-1} \ast f_A(v) \ast f_A(\epsilon)^{-1} & \text{(from equation~\eqref{eq:2})} \\
    & = f_B(u)  \ast f_B(\epsilon)^{-1} \ast f_A(v) & \text{(by cancellation)} \\
    & = f_A(v) \ast f_B(u)  \ast f_B(\epsilon)^{-1} & \text{(by commutativity)} \\
    & = f_A(vu) & \text{(from equation~\eqref{eq:4})}
    \end{align*}
    This completes the proof of the claim.
    \end{proof}

    \noindent
    For last intermediate step, we use the claim to show the following equalities:
    \begin{equation}
        f(uw) = f(wu) \quad \text{for every } u,w \in \Sigma^* \label{eq:cyclic_commutative}
    \end{equation}
    This is because:
    \begin{align*}
    f(uw) & = f_A(uw) \ast f_B(\epsilon) & \\
    & = f_A(wu) \ast f_B(\epsilon) & \text{(by the claim)} \\
    & = f(wu) &
    \end{align*}
    Also, for every $a,b \in \Sigma$ and every word $u \in \Sigma^*$, we have:
    \begin{equation}
        f(abu) = f(bau) \label{eq:adjacent_commutative}
    \end{equation}
    This is because:
    \begin{align*}
    f(abu) & = f_A(ab) \ast f_B(u) & \\
    & = f_A(ba) \ast f_B(u) & \text{(by the claim)} \\
    & = f(bau) &
    \end{align*}
    And symmetrically, for every $a,b \in \Sigma$ and every word $u \in \Sigma^*$, we have:
    \begin{equation}
        f(uab)= f(uba) \label{eq:adjacent_commutative_2}
    \end{equation}
    with similar reasoning.
    Now it is not had to see that using Equations~\eqref{eq:cyclic_commutative}, \eqref{eq:adjacent_commutative}, and \eqref{eq:adjacent_commutative_2}, we can transform any word $u$ into any permutation $\pi(u)$ of $u$ by a sequence of such transformations, proving that $f(u) = f(\pi(u))$. This completes the proof of the theorem.
\end{proof}

\begin{corollary}
\label{cor:commutative-signal-free-homomorphism}
Let $(M, \ast, e)$ be a commutative monoid, and let $f_A, f_B: \Sigma^* \to M$ be two functions that define a signal-free aggregation protocol over $M$. Then the function $f: \Sigma^* \to M$ computed by the protocol is commutative. That is, for every word $u \in \Sigma^*$ and every permutation $\pi$ of the positions of $u$, we have $f(u) = f(\pi(u))$.
\end{corollary}
\begin{proof}
    This is a direct consequence of Theorems~\ref{thm:signal-free-homomorphism} and~\ref{thm:commutative-signal-free}. It is enough to observe that $f$ can be expressed as:
    \[f(w) = s_A \ast h(w) \ast s_B \quad \text{for every } w \in \Sigma^*\]
    where $h: \Sigma^* \to M$ is a homomorphism from the free monoid $\Sigma^*$ to the monoid $M$, and $s_A, s_B \in M$. Now observe that the inner function $h$ can be expressed with signal-free protocols that satisfy the conditions of Theorem~\ref{thm:commutative-signal-free}. Therefore, $h$ is commutative hence $f$ is also commutative.
\end{proof}